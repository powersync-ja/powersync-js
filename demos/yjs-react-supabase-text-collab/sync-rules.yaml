# yaml-language-server: $schema=https://unpkg.com/@powersync/service-sync-rules@latest/schema/sync_rules.json

# Sync-rule docs: https://docs.powersync.com/usage/sync-rules
bucket_definitions:
  documents:
    # Allow remote changes to be synchronized even while there are local changes
    priority: 0
    parameters: SELECT (request.parameters() ->> 'document_id') as document_id
    data:
      - SELECT * FROM documents WHERE id = bucket.document_id
      - SELECT id, document_id, base64(update_data) as update_b64 FROM document_updates WHERE document_id = bucket.document_id
